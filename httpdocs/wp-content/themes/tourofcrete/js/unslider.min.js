jQuery(function() {
    jQuery('#fader img:not(:first)').hide();
    jQuery('#fader img').css('position', 'absolute');
    jQuery('#fader img').css('top', '0px');
    jQuery('#fader img').css('left', '50%');
    jQuery('#fader img').each(function() {
        var img = jQuery(this);
        jQuery('<img>').attr('src', jQuery(this).attr('src')).load(function() {
            img.css('margin-left', -this.width / 2 + 'px');
        });
    });

    var pause = false;
    
    function fadeNext() {
        jQuery('#fader img').first().fadeOut('slow').appendTo(jQuery('#fader'));
        jQuery('#fader img').first().fadeIn('slow');
    }

    function fadePrev() {
        jQuery('#fader img').first().fadeOut('slow');
        jQuery('#fader img').last().prependTo(jQuery('#fader')).fadeIn('slow');
    }

    jQuery('#fader, #next').click(function() {
        fadeNext();
    });

    jQuery('#prev').click(function() {
        fadePrev();
    });

    jQuery('#fader, .button').hover(function() {
        pause = true;
    },function() {
        pause = false;
    });

    function doRotate() {
        if(!pause) {
            fadeNext();
        }    
    }
    
    var rotate = setInterval(doRotate, 2000);
});